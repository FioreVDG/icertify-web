<div class="grid">
  <!-- FILTER BUTTONS  -->
  <div
    *ngIf="filterButtonConfig"
    class="col-12 flex justify-content-end flex-wrap mb-1"
  >
    <button
      mat-raised-button
      class="filt-btn"
      *ngFor="let btn of filterButtonConfig; let i = index"
      [color]="btn.selected ? 'primary' : ''"
      (click)="onFilterButtonClick(btn.label)"
    >
      {{ btn.label }}
    </button>
  </div>
  <div class="col-12 main">
    <mat-toolbar>
      <!-- SEARCHBOX -->
      <div class="search-box">
        <button class="btn-search" (click)="onTriggerSearch()">
          <mat-icon>search</mat-icon>
        </button>
        <input
          type="text"
          [class]="!keyword.length ? 'input-search' : 'input-toggle'"
          [(ngModel)]="keyword"
          (keyup.enter)="onTriggerSearch()"
        />
      </div>
      <div class="flex-stretch"></div>

      <!-- CHECKBOX BUTTONS -->
      <div
        *ngIf="buttonConfig && checkedRows.selected.length"
        class="flex justify-content-end flex-wrap"
      >
        <button
          mat-raised-button
          class="checkbox-btn"
          *ngFor="let btn of buttonConfig.checkBoxBtnConfig"
          (click)="checkBoxBtnClick(btn.action)"
        >
          {{ btn.label }}
        </button>
      </div>
    </mat-toolbar>

    <!-- TABLE -->
    <div class="table-responsive">
      <table mat-table [dataSource]="dataSource" *ngIf="!loading">
        <ng-container matColumnDef="select" *ngIf="checkBox">
          <th mat-header-cell class="pr-2" *matHeaderCellDef>
            <!-- CHECKBOX -->
            <mat-checkbox
              *ngIf="!isLimit && uniqueCheckbox === false"
              [indeterminate]="
                checkedRows.hasValue() &&
                dataSource.length !== checkedRows.selected.length
              "
              [checked]="
                checkedRows.hasValue() &&
                dataSource.length === checkedRows.selected.length &&
                !isLimit
              "
              [disabled]="isLimit"
              (click)="$event.stopPropagation()"
              (change)="$event ? checkAll() : null"
            >
            </mat-checkbox>
          </th>
          <td
            mat-cell
            *matCellDef="let row; let i = index"
            class="pr-2"
            (click)="$event.stopPropagation()"
          >
            <span>
              <mat-checkbox
                [checked]="autoCheck(row, i)"
                [disabled]="
                  checkBoxDisableField
                    ? row[checkBoxDisableField.column] ==
                      (checkBoxDisableField.value == 'null'
                        ? null
                        : checkBoxDisableField.value == 'undefined'
                        ? undefined
                        : checkBoxDisableField.value)
                    : isLimit
                    ? true
                    : false
                "
                (click)="$event.stopPropagation()"
                (change)="$event ? onCheckBoxClick(row) : null"
              >
              </mat-checkbox>
            </span>
          </td>
        </ng-container>

        <ng-container *ngFor="let col of columns">
          <ng-container matColumnDef="{{ col.path }}">
            <th mat-header-cell class="pr-2" *matHeaderCellDef mat-sort-header>
              {{ col.title }}
            </th>
            <td mat-cell *matCellDef="let element" (click)="rowClick(element)">
              <span
                *ngIf="
                  col.type !== 'special' &&
                  col.type !== 'date' &&
                  !col.textColor
                "
                >{{ col.path === "mobileNumber" ? "(+63)" : ""
                }}{{ util.deepFind(element, col.path) }}</span
              >
              <span
                *ngIf="
                  col.type !== 'special' && col.type !== 'date' && col.textColor
                "
                [ngStyle]="{
                  color: getTextColor(col, util.deepFind(element, col.path))
                }"
                >{{ col.path === "mobileNumber" ? "(+63)" : ""
                }}{{ util.deepFind(element, col.path) }}</span
              >

              <ng-container *ngIf="col.type === 'special'">
                <span *ngFor="let c of col.paths"
                  >{{ util.deepFind(element, c) | uppercase }}
                </span></ng-container
              >
              <span *ngIf="col.type === 'date'">{{
                util.deepFind(element, col.path) | date: "medium"
              }}</span>
            </td>
          </ng-container>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns; let i = index"
        ></tr>
      </table>
      <mat-paginator
        style="border-top: 1px solid #26184aac"
        *ngIf="dataSource && dataSource.length && !loading && pagination"
        [length]="dataLength"
        [pageSize]="pagination.pageSize"
        [pageIndex]="pagination.pageIndex - 1"
        [pageSizeOptions]="[5, 10, 15, 25, 50]"
        showFirstLastButtons
        (page)="onClickPagination($event)"
      >
      </mat-paginator>

      <!-- BOTTOM BUTTONS -->
      <div
        *ngIf="buttonConfig.bottomButtons"
        class="col-12 flex justify-content-end flex-wrap mb-1"
      >
        <button mat-raised-button>Test</button>
      </div>

      <!-- LOADER -->
      <div *ngIf="!dataSource?.length && !loading" align="center">
        <p>No Records Found</p>
      </div>
      <div *ngIf="loading" class="loading mt-4">
        <ngx-skeleton-loader
          count="5"
          animation="progress-dark"
          [theme]="{
            height: '38px',
            'background-color': '#efefef',
            border: '1px solid #',
            'animation-duration': '1s'
          }"
        ></ngx-skeleton-loader>
      </div>
    </div>
  </div>
</div>
